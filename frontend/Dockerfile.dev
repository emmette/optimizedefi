FROM node:20-alpine

WORKDIR /app

# We'll let the command handle everything since volumes override the filesystem
CMD ["sh", "-c", "if [ ! -d node_modules ]; then npm ci; fi && npm run dev"]